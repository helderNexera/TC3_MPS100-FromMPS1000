<?xml version="1.0" encoding="utf-8"?>
<TcPlcObject Version="1.1.0.1" ProductVersion="3.1.4022.18">
  <GVL Name="Global_Variables" Id="{152ff645-d29f-48b8-8b5c-5d2113ebf33d}">
    <Declaration><![CDATA[{attribute 'Tc2GvlVarNames'}
(*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  GLOBAL CONFIGURATION SPECIFIC TO SOLD MACHINE
 *)
VAR_GLOBAL PERSISTENT
	bUseMDEOption							: BOOL							:= TRUE;	(* MDE option for ETA *)
	bUseRTPOption							: BOOL							:= FALSE;	(* REAL-TIME pearling screen option *)
	bUseTurnOverOption						: BOOL							:= FALSE;	(* TurnOver module is fitted *)
	bUseASOption							: BOOL							:= FALSE;	(* Auto-Sampling screen option *)
	bUseNewBarrelFunction					: BOOL							:= TRUE;	(* Specific function to use 1-4 sectors for each gripper *)
	bUse103059Kludges						: BOOL							:= FALSE;	(* Specific to Blancpain to correct mechanical issues *)
	bRejectPartWithVacuumErrorOnTable		: BOOL							:= FALSE;	(* Try to reject a part if vacuum on table was bad when dropping from loader *)
	bUseFullTapeWidth						: BOOL							:= FALSE;	(* Use full tape width, half for roughing, other half for finish *)
	bUsePearlMoveToSafe						: BOOL							:= FALSE;	(* Use the feature to not move to preref between pearls to save time *)
	bUseLockPlate							: bool							:= False; 	(* Use the lock plate option of the Lifts *)
(* Optimisations *)
	bUse103171OptimA1						: BOOL							:= FALSE;	(* Specific optimisation specified in document 502004-3TC-0001-07 *)
	bUse103171OptimB3						: BOOL							:= FALSE;	(* Specific optimisation specified in document 502004-3TC-0001-07 *)
	bUse103171OptimB5PreMoveXY				: BOOL							:= FALSE;	(* Specific optimisation specified in document 502004-3TC-0001-07 : Pre-move XY to safe when waiting for others *)
	bUse103171OptimB5MoveOnPreSafeZ			: BOOL							:= FALSE;	(* Specific optimisation specified in document 502004-3TC-0001-07 : Say Z in safe if near by safe position even if not in position *)
	bUse103171OptimB5CleanOnBothSide		: BOOL							:= FALSE;	(* Specific optimisation specified in document 502004-3TC-0001-07 : Clean on both side *)
	bUse103171OptimB5CleanOn1Move			: BOOL							:= FALSE;	(* Specific optimisation specified in document 502004-3TC-0001-07 : Clean only on 1 move (no return back *)
END_VAR
VAR_GLOBAL CONSTANT
	C_MAX_NB_OF_ERRORS						: INT							:= 159;		(* 160 errors *)
	C_MAX_NB_OF_PARTS_ON_PLATE				: INT							:= 99;		(* Max nb of parts on plate : 100*)
	C_MAX_NB_OF_PEARLS						: INT							:= 600;		(* Max NB of pearls on 1 side and 1 diameter *)
	C_NB_OF_COM								: INT							:=1;		(* Nb of serial ports *)
	C_COM_NUMBERS							: ARRAY[1..C_NB_OF_COM] OF INT	:= [1];		(* List of serial ports com numbers *)
	C_WEIGHT_TABLE_MAX						: INT							:=25;		(* Nb of point for weight calibration *)
	C_PROD_MODE_GOOD_PART					: BOOL							:= FALSE;	(* False -> Prod quantity is the number of parts on the lift / True -> Prod quantity is the good produced part *)
END_VAR
(*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*)
VAR_GLOBAL
(* For MDE *)
	{attribute 'OPC.UA.DA' := '1'}
  	{attribute 'OPC.UA.DA.StructuredType' := '1'}
	TMDEData								: TMDE; 									(* TMDE Data *)
(* Internal data *)
	RxBuffer_MCR							: ARRAY[1..C_NB_OF_COM] OF ComBuffer;		(* Reception buffer for MCR *)
	TxBuffer_MCR							: ARRAY[1..C_NB_OF_COM] OF ComBuffer;		(* Transmission buffer for MCR *)
(* Digital IOs *)
	(* Twinsafe *)
	IbV1PowerIsOff					AT %I*	: BOOL;										(* TWINSAFE : Power V1 is off *)
	IbDrivesAreOFF					AT %I*	: BOOL;										(* TWINSAFE : Power on drives is off *)
	IbNoEmergencyStop				AT %I*	: BOOL;										(* TWINSAFE : Emergency stop not pressed *)
	QbStartSafety					AT %Q*	: BOOL;										(* TWINSAFE : Start the safety **Always set to true** *)
	QbPowerOnDrives					AT %Q*	: BOOL;										(* TWINSAFE : Power on drives **Always set to true** *)
	QbResetSafety					AT %Q*	: BOOL;										(* TWINSAFE : Reset the safety errors *)
	(* Doors *)
	IbPearlingDoorsClosed			AT %I*	: BOOL;										(* Pearling doors are closed *)
	IbPearlingDoorsLocked			AT %I*	: BOOL;										(* Pearling doors are locked *)
	IbLoaderDoorsClosed				AT %I*	: BOOL;										(* Loader doors are closed *)
	IbLoaderDoorsLocked				AT %I*	: BOOL;										(* Loader doors are locked *)
	QbLockPearlingDoors				AT %Q*	: BOOL;										(* Lock door on pearling *)
	QbLockLoaderDoors				AT %Q*	: BOOL;										(* Lock door on loader *)
	(* Power supplies *)
	Ib24VOK							AT %I*	: BOOL;										(* 24V power supplies are OK *)
	Ib48VOK							AT %I*	: BOOL;										(* 48V power supplies are OK *)
	(* Light Tower *)
	QbGreenLight					AT %Q*	: BOOL;										(* Green light *)
	QbRedLight						AT %Q*	: BOOL;										(* Red light *)
	QbBlueLight						AT %Q*	: BOOL;										(* Yellow light *)
	(*Air pressure *)
	IbAirPressureOK					AT %I*	: BOOL;										(* Air pressure is OK *)
	(* Vacuum *)
	IbVacuumPumpIsOn				AT %I*	: BOOL;										(* Vacuum pump is powered *)
	IbMainVacuumOK					AT %I*	: BOOL;										(* main vacuum is OK *)
	QbVacuumPumpOn					AT %Q*	: BOOL;										(* Activate vacuum pump *)
	(* Aspiration *)
	IbAspirationIsOn				AT %I*	: BOOL;										(* Aspiration is powered *)
	IbAspirationOK					AT %I*	: BOOL;										(* Aspiration is OK *)
	QbAspirationOn					AT %Q*	: BOOL;										(* Activate aspirator *)
	(* Lift 1 *)
	IbLift1Home						AT %I*	: BOOL;										(* Lift 1 is at home *)
	IbLift1PosLimit					AT %I*	: BOOL;										(* Lift 1 is not down *)
	IbLift1NegLimit					AT %I*	: BOOL;										(* Lift 1 is not up *)
	IbLift1PlateInPos				AT %I*	: BOOL;										(* Plate on lift 1 is in position *)
	IbLift1DrawerInPos				AT %I*	: BOOL;										(* Drawer of lift 1 is in position *)
	IbLift1DrawerLocked				AT %I*	: BOOL;										(* Drawer of lift 1 is locked *)
	IbLift1DrawerUnlocked			AT %I*	: BOOL;										(* Drawer of lift 1 is unlocked *)
	IbLift1PlateLocked				AT %I*	: BOOL;										(* Lift 1 plate is locked *)
	IbLift1PlateUnlocked			AT %I*	: BOOL;										(* Lift 1 plate is unlocked *)
	QbLift1BlueLight				AT %Q*	: BOOL;										(* Blue light for left lift *)
	QbLift1LockPlate				AT %Q*	: BOOL;										(* Lock plate of lift 1 *)
	QbLift1UnlockPlate				AT %Q*	: BOOL;										(* Unlock plate of lift 1 *)
	QbLift1LockDrawer				AT %Q*	: BOOL;										(* Lock drawer of lift 1 *)
	QbLift1UnlockDrawer				AT %Q*	: BOOL;										(* Unlock drawer of lift 1 *)
	(* Lift 2 *)
	IbLift2Home						AT %I*	: BOOL;										(* Lift 1 is at home *)
	IbLift2PosLimit					AT %I*	: BOOL;										(* Lift 2 is not down *)
	IbLift2NegLimit					AT %I*	: BOOL;										(* Lift 2 is not up *)
	IbLift2PlateInPos				AT %I*	: BOOL;										(* Plate on lift 2 is in position *)
	IbLift2DrawerInPos				AT %I*	: BOOL;										(* Drawer of lift 2 is in position *)
	IbLift2DrawerLocked				AT %I*	: BOOL;										(* Drawer of lift 2 is locked *)
	IbLift2DrawerUnlocked			AT %I*	: BOOL;										(* Drawer of lift 2 is unlocked *)
	IbLift2PlateLocked				AT %I*	: BOOL;										(* Lift 2 plate is locked *)
	IbLift2PlateUnlocked			AT %I*	: BOOL;										(* Lift 2 plate is unlocked *)
	QbLift2BlueLight				AT %Q*	: BOOL;										(* Blue light for right lift *)
	QbLift2LockPlate				AT %Q*	: BOOL;										(* Lock plate of lift 2 *)
	QbLift2UnlockPlate				AT %Q*	: BOOL;										(* Unlock plate of lift 2 *)
	QbLift2LockDrawer				AT %Q*	: BOOL;										(* Lock drawer of lift 2 *)
	QbLift2UnlockDrawer				AT %Q*	: BOOL;										(* Unlock drawer of lift 2 *)
	(* Reject *)
	IbRejectPlateInPos				AT %I*	: BOOL;										(* Plate on reject is in position *)
	IbRejectDrawerInPos				AT %I*	: BOOL;										(* Drawer for reject is in position *)
	QbRejectBlueLight				AT %Q*	: BOOL;										(* Blue light for reject *)
	(* Loader *)
	ILoaderMotorXYStatus			AT %I*	: WORD;										(* Digital inputs from loader XY drive *)
	IbLoaderHomeZ1					AT %I*	: BOOL;										(* Home for Head 1 Z axis *)
	IbLoaderPosLimitZ1				AT %I*	: BOOL;										(* Pos. llimit for Head 1 Z axis *)
	IbLoaderNegLimitZ1				AT %I*	: BOOL;										(* Neg. llimit for Head 1 Z axis *)
	IbLoaderHomeZ2					AT %I*	: BOOL;										(* Home for Head 2 Z axis *)
	IbLoaderPosLimitZ2				AT %I*	: BOOL;										(* Pos. llimit for Head 2 Z axis *)
	IbLoaderNegLimitZ2				AT %I*	: BOOL;										(* Neg. llimit for Head 2 Z axis *)
	IbLoaderPlateTakerIsUp			AT %I*	: BOOL;										(* Plate taker is up *)
	IbLoaderPlateTakerIsDown		AT %I*	: BOOL;										(* Plate taker is down *)
	IiLoaderHead1Vacuum				AT %I*	: INT;										(* Vacuum flow on head 1 *)
	IiLoaderHead2Vacuum				AT %I*	: INT;										(* Vacuum flow on head 2 *)
	IbLoaderPlateVacuumOK			AT %I*	: BOOL;										(* Vacuum on plate is OK *)
	ILoaderPlateDistance			AT %I*	: INT;										(* Distance from head to plate *)
	QbLoaderActivateHead1Vacuum		AT %Q*	: BOOL;										(* Activate Head 1 vacuum *)
	QbLoaderActivateHead1Blowing	AT %Q*	: BOOL;										(* Activate Head 1 blowing *)
	QbLoaderActivateHead2Vacuum		AT %Q*	: BOOL;										(* Activate Head 2 vacuum *)
	QbLoaderActivateHead2Blowing	AT %Q*	: BOOL;										(* Activate Head 2 blowing *)
	QbLoaderActivatePlateVacuum		AT %Q*	: BOOL;										(* Activate plate vacuum *)
	QbLoaderActivatePlateBlowing	AT %Q*	: BOOL;										(* Activate plate blowing *)
	QbLoaderPlateTakerDown			AT %Q*	: BOOL;										(* Move down the plate taker part *)
	QbLoaderPlateTakerUp			AT %Q*	: BOOL;										(* Move up the plate taker part *)
	QbLoaderBrushAspirationVacuum	AT %Q*	: BOOL;										(* Activate aspiration on cleaning brush *)
	QbLoaderBrushAspirationBlowing	AT %Q*	: BOOL;										(* Deactivate aspiration on cleaning brush *)
	(* Table *)
	IbTableHome						AT %I*	: BOOL;										(* Home for rotation axis *)
	IbTableLocked					AT %I*	: BOOL;										(* Table is locked in position *)
	IbTableNotLocked				AT %I*	: BOOL;										(* Table is not locked in position *)
	IiTableVacuumPos1Flow			AT %I*	: INT;										(* Vacuum flow on position 1 *)
	IiTableVacuumPos2Flow			AT %I*	: INT;										(* Vacuum flow on position 2 *)
	IiTableVacuumPos3Flow			AT %I*	: INT;										(* Vacuum flow on position 3 *)
	IiTableVacuumPos4Flow			AT %I*	: INT;										(* Vacuum flow on position 4 *)
	IbTableAspirationIsUp			AT %I*	: BOOL;										(* Aspiration module is up *)
	IbTableAspirationIsDown			AT %I*	: BOOL;										(* Aspiration module is down *)
	IbTableCleanBrushIsUp			AT %I*	: BOOL;										(* Clean brush is up *)
	IbTableCleanBrushIsDown			AT %I*	: BOOL;										(* Clean brush is down *)
	QbTableLock						AT %Q*	: BOOL;										(* Lock the table in position *)
	QbTableActivateVacuumPos1		AT %Q*	: BOOL;										(* Activate vacuum on position 1 *)
	QbTableActivateBlowingPos1		AT %Q*	: BOOL;										(* Activate blowing on position 1 *)
	QbTableActivateVacuumPos2		AT %Q*	: BOOL;										(* Activate vacuum on position 2 *)
	QbTableActivateBlowingPos2		AT %Q*	: BOOL;										(* Activate blowing on position 2 *)
	QbTableActivateVacuumPos3		AT %Q*	: BOOL;										(* Activate vacuum on position 3 *)
	QbTableActivateBlowingPos3		AT %Q*	: BOOL;										(* Activate blowing on position 3 *)
	QbTableActivateVacuumPos4		AT %Q*	: BOOL;										(* Activate vacuum on position 4 *)
	QbTableActivateBlowingPos4		AT %Q*	: BOOL;										(* Activate blowing on position 4 *)
	QbTableAspiration13Vacuum		AT %Q*	: BOOL;										(* Activate aspiration on left position *)
	QbTableAspiration13Blowing		AT %Q*	: BOOL;										(* Activate aspiration on right position *)
	QbTableAspiration24Vacuum		AT %Q*	: BOOL;										(* Deactivate aspiration on left position *)
	QbTableAspiration24Blowing		AT %Q*	: BOOL;										(* Deactivate aspiration on right position *)
	QbTableAspirationUp				AT %Q*	: BOOL;										(* Move aspiration module down *)
	QbTableAspirationDown			AT %Q*	: BOOL;										(* Move aspiration module down *)
	QbTableCleanBrushDown			AT %Q*	: BOOL;										(* Move clean brush down *)
	(* Brush *)
	IbBrushHome						AT %I*	: BOOL;										(* Home for Brush axis *)
	IbBrushPosLimit					AT %I*	: BOOL;										(* Pos. llimit for Brush axis *)
	IbBrushNegLimit					AT %I*	: BOOL;										(* Neg limit for Brush axis *)
	QbBrushAspirationVacuum			AT %Q*	: BOOL;										(* Activate aspiration on cleaning brush *)
	QbBrushAspirationBlowing		AT %Q*	: BOOL;										(* Deactivate aspiration on cleaning brush *)
	(* Pearling *)
	IPearlingMotorXYStatus			AT %I*	: WORD;										(* Digital inputs from pearling XY drive *)
	IbPearlingHomeZ1				AT %I*	: BOOL;										(* Home for Z1 axis *)
	IbPearlingPosLimitZ1			AT %I*	: BOOL;										(* Pos. llimit for Z1 axis *)
	IbPearlingNegLimitZ1			AT %I*	: BOOL;										(* Neg. llimit for Z1 axis *)
	IbPearlingHomeZ2				AT %I*	: BOOL;										(* Home for Z2 axis *)
	IbPearlingPosLimitZ2			AT %I*	: BOOL;										(* Pos. llimit for Z2 axis *)
	IbPearlingNegLimitZ2			AT %I*	: BOOL;										(* Neg. llimit for Z2 axis *)
	IbPearlingChuck1Open			AT %I*	: BOOL;										(* Chuck 1 is open *)
	IbPearlingChuck1Closed			AT %I*	: BOOL;										(* Chuck 1 is closed *)
	IbPearlingChuck2Open			AT %I*	: BOOL;										(* Chuck 2 is open *)
	IbPearlingChuck2Closed			AT %I*	: BOOL;										(* Chuck 2 is closed *)
	IbPearlingChangeBroach			AT %I*	: BOOL;										(* Request change broach button*)
	IPearlingContact1Distance		AT %I*	: INT;										(* Distance from sensor to stick 1 contact *)
	IPearlingContact2Distance		AT %I*	: INT;										(* Distance from sensor to stick 2 contact *)
	IPearlingWeightMeasure			AT %I*	: INT;										(* Weight on load sensor *)
	QbPearlingStartMotor1			AT %Q*	: BOOL;										(* Start the pearling 1 motor *)
	QbPearlingStartMotor2			AT %Q*	: BOOL;										(* Start the pearling 2 motor *)
	QbPearlingOpenChuck1			AT %Q*	: BOOL;										(* Open chuck 1 *)
	QbPearlingOpenChuck2			AT %Q*	: BOOL;										(* Open chuck 2 *)
	QbPearlingActivateEject1		AT %Q*	: BOOL;										(* Activate stick 1 ejection *)
	QbPearlingActivateEject2		AT %Q*	: BOOL;										(* Activate stick 2 ejection *)
	QbPearlingActivateBlowing1		AT %Q*	: BOOL;										(* Activate blowing 1 *)
	QbPearlingActivateBlowing2		AT %Q*	: BOOL;										(* Activate blowing 2 *)
	QbPearlingStickLed1				AT %Q*	: BOOL;										(* Stick 1 led is on *)
	QbPearlingStickLed2				AT %Q*	: BOOL;										(* Stick 2 led is on *)
	QbPearlingChangeBroachLight		AT %Q*	: BOOL;										(* Request change broach button light*)
	(* TurnOver *)
	IbTurnOverHome					AT %I*	: BOOL;										(* Home for axis *)
	IbTurnOverArmVacuumOK			AT %I*	: BOOL;										(* Vacuum is OK on arm *)
	IbTurnOverFixVacuumOK			AT %I*	: BOOL;										(* Vacuum is OK on fix position *)
	IbTurnOverFixIsUp				AT %I*	: BOOL;										(* Fix is up *)
	IbTurnOverFixIsDown				AT %I*	: BOOL;										(* Fix is down *)
	QbTurnOverActivateVacuumArm		AT %Q*	: BOOL;										(* Activate vacuum on arm *)
	QbTurnOverActivateBlowingArm	AT %Q*	: BOOL;										(* Activate blowing on arm *)
	QbTurnOverActivateVacuumFix		AT %Q*	: BOOL;										(* Activate vacuum on fix position *)
	QbTurnOverActivateBlowingFix	AT %Q*	: BOOL;										(* Activate blowing on fix position *)
	QbTurnOverMoveFixUp				AT %Q*	: BOOL;										(* Move fix up *)
	QbTurnOverMoveFixDown			AT %Q*	: BOOL;										(* Move fix down *)
	QbTurnOverActivateCleaningBlow	AT %Q*	: BOOL;										(* Activate blowing to clean the holder *)
	(* Sharpen *)
	IbSharpenPosTensioner			AT %I*	: BOOL;										(* The sharpening band is not empty *)
	QbSharpenAspirationVacuum		AT %Q*	: BOOL;										(* Activate aspiration on sharpen*)
	QbSharpenAspirationBlowing		AT %Q*	: BOOL;										(* Deactivate aspiration on sharpen*)
	(* Barrel *)
	IbBarrelStickIsUp				AT %I*	: BOOL;										(* Stick is up *)
	IbBarrelStickIsDown				AT %I*	: BOOL;										(* Stick is down *)
	IbBarrelStickPresent			AT %I*	: BOOL;										(* A stick is present on sensor *)
	IbBarrelIndexed					AT %I*	: BOOL;										(* The barrel is indexed *)
	IbBarrelNotIndexed				AT %I*	: BOOL;										(* The barrel is not indexed *)
	QbBarrelMoveUpStick				AT %Q*	: BOOL;										(* Move up stick *)
	QbBarrelIndexTable				AT %Q*	: BOOL;										(* Move up index *)
	(* Axis *)
	TLoaderXAxis							: AXIS_REF				;					(* linked to loader X axis var in TWINCAT System Manager *)
	TLoaderYAxis							: AXIS_REF;									(* linked to loader Y axis var in TWINCAT System Manager *)
	TLoaderZ1Axis							: AXIS_REF;									(* linked to loader Head 1 Z axis var in TWINCAT System Manager *)
	TLoaderZ2Axis							: AXIS_REF;									(* linked to  loader Head 2 Z axis var in TWINCAT System Manager *)
	TLoaderThetaAxis						: AXIS_REF;									(* linked to  loader Theta axis var in TWINCAT System Manager *)
	TLift1Axis								: AXIS_REF;									(* linked to left lift axis var in TWINCAT System Manager *)
	TLift2Axis								: AXIS_REF;									(* linked to right lift axis var in TWINCAT System Manager *)
	TPearlingXAxis							: AXIS_REF;									(* linked to pearling X axis var in TWINCAT System Manager *)
	TPearlingYAxis							: AXIS_REF;									(* linked to pearling Y axis var in TWINCAT System Manager *)
	TPearlingZ1Axis							: AXIS_REF;									(* linked to pearling Z1 axis var in TWINCAT System Manager *)
	TPearlingZ2Axis							: AXIS_REF;									(* linked to pearling Z2 axis var in TWINCAT System Manager *)
	TTableAxis								: AXIS_REF;									(* linked to table axis var in TWINCAT System Manager *)
	TTurnOverAxis							: AXIS_REF;									(* linked to turn over axis var in TWINCAT System Manager *)
	TSharpenAxis							: AXIS_REF;									(* linked to sharpen axis var in TWINCAT System Manager *)
	TSharpenEncoder							: AXIS_REF;									(* linked to sharpen encoder var in TWINCAT System Manager *)
	TBarrelAxis								: AXIS_REF;									(* linked to barrel axis var in TWINCAT System Manager *)
	TBrushAxis								: AXIS_REF;									(* linked to brush axis var in TWINCAT System Manager *)
END_VAR]]></Declaration>
  </GVL>
</TcPlcObject>